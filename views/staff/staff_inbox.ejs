<link rel="stylesheet" href="/css/admin/circular/circular.css">

<% function formatDate(date) { const formattedDate=new Date(date); const options={ day: '2-digit' , month: '2-digit' ,
    year: 'numeric' }; return formattedDate.toLocaleDateString('en-GB', options); } %>

    <% function formatTime(date) { const formattedTime=new Date(date); const hours=formattedTime.getHours() % 12 || 12;
        const minutes=formattedTime.getMinutes(); const ampm=formattedTime.getHours()>= 12 ? 'PM' : 'AM';

        return `${hours}:${minutes.toLocaleString('en-US', { minimumIntegerDigits: 2 })} ${ampm}`;
        } %>

<div class="window" id="window_layout">
    <div class="window_navbar">
        <%- include('../partials/staff/navigation_bar.ejs',{circularNotification}) %>
    </div>
    <div class="window_container">
            <div class="container center_title">
                Inbox
            </div>

            <!-- Previous Circulars -->
            <% circular.reverse().forEach(function(item) { %>
                <% if(item.delete === false) { %>
                <div></div>
                <a href="/staff/message_seen/<%-staffdata[0]._id%>/<%- item._id %>">

                    <div class="circular_container">   
                        <div class="circular_header">
                            <div class="circular_info">
                                <div class="from">From : <%- item.from %> </div>
                                <div class="time">Date : <%- formatDate(item.date) %> </div>
                                <div class="time">Time : <%- formatTime(item.date) %> </div>
                                    <%if(unSeenCirculars.includes(item._id)){%>
                                        <h1 style="color: green;">new</h1>
                                    <%}%>
                            </div>
                            
                        </div>
                </div>
            </a>
            <% } %>
        <% }) %> 
        </div> 
    </div>
        <script>
            function showSeenCircularContainer(staffId, circularId) {
                document.getElementById('seenCircularContainer').style.display = 'flex';
                document.getElementById('seenCircular').href = `/staff/message_seen/${staffId}/${circularId}`
            }
            function hideSeenCircularContainer() {
                document.getElementById('seenCircularContainer').style.display = 'none';
            }
        </script>